<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 400">
  <defs>
    <linearGradient id="userGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1d4ed8;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="uiGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="cpGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="idpGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#d97706;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="3" stdDeviation="4" flood-opacity="0.15"/>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#64748b"/>
    </marker>
    <marker id="arrowReturn" markerWidth="10" markerHeight="10" refX="0" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M9,0 L9,6 L0,3 z" fill="#10b981"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="850" height="400" fill="#f8fafc"/>

  <!-- Entity boxes at top -->
  <g filter="url(#shadow)">
    <rect x="40" y="20" width="120" height="60" rx="10" fill="url(#userGrad)"/>
    <text x="100" y="55" text-anchor="middle" fill="white" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="600">User</text>
  </g>

  <g filter="url(#shadow)">
    <rect x="280" y="20" width="120" height="60" rx="10" fill="url(#uiGrad)"/>
    <text x="340" y="55" text-anchor="middle" fill="white" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="600">Web UI</text>
  </g>

  <g filter="url(#shadow)">
    <rect x="480" y="20" width="140" height="60" rx="10" fill="url(#cpGrad)"/>
    <text x="550" y="55" text-anchor="middle" fill="white" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="600">Control Plane</text>
  </g>

  <g filter="url(#shadow)">
    <rect x="720" y="20" width="100" height="60" rx="10" fill="url(#idpGrad)"/>
    <text x="770" y="55" text-anchor="middle" fill="white" font-family="Arial, Helvetica, sans-serif" font-size="14" font-weight="600">IdP</text>
  </g>

  <!-- Vertical lines -->
  <line x1="100" y1="80" x2="100" y2="380" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="340" y1="80" x2="340" y2="380" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="550" y1="80" x2="550" y2="380" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="770" y1="80" x2="770" y2="380" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="5,5"/>

  <!-- Step 1: Access Web UI -->
  <line x1="105" y1="120" x2="330" y2="120" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="150" y="105" width="130" height="24" rx="4" fill="white" stroke="#e2e8f0"/>
  <text x="215" y="122" text-anchor="middle" fill="#1e293b" font-family="Arial, Helvetica, sans-serif" font-size="11" font-weight="500">1. Access Web UI</text>

  <!-- Step 2: Redirect to IdP -->
  <line x1="345" y1="170" x2="765" y2="170" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="480" y="155" width="130" height="24" rx="4" fill="white" stroke="#e2e8f0"/>
  <text x="545" y="172" text-anchor="middle" fill="#1e293b" font-family="Arial, Helvetica, sans-serif" font-size="11" font-weight="500">2. Redirect to IdP</text>

  <!-- Step 3: Authenticate -->
  <line x1="765" y1="220" x2="110" y2="220" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrowReturn)"/>
  <rect x="380" y="205" width="130" height="24" rx="4" fill="white" stroke="#e2e8f0"/>
  <text x="445" y="222" text-anchor="middle" fill="#1e293b" font-family="Arial, Helvetica, sans-serif" font-size="11" font-weight="500">3. Authenticate</text>

  <!-- Step 4: Callback with token -->
  <line x1="105" y1="270" x2="540" y2="270" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="555" y1="270" x2="765" y2="270" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrowReturn)"/>
  <rect x="280" y="255" width="160" height="24" rx="4" fill="white" stroke="#e2e8f0"/>
  <text x="360" y="272" text-anchor="middle" fill="#1e293b" font-family="Arial, Helvetica, sans-serif" font-size="11" font-weight="500">4. Callback with token</text>

  <!-- Step 5: Create session -->
  <line x1="545" y1="320" x2="110" y2="320" stroke="#10b981" stroke-width="2" marker-end="url(#arrowReturn)"/>
  <rect x="280" y="305" width="130" height="24" rx="4" fill="white" stroke="#e2e8f0"/>
  <text x="345" y="322" text-anchor="middle" fill="#1e293b" font-family="Arial, Helvetica, sans-serif" font-size="11" font-weight="500">5. Create session</text>
</svg>